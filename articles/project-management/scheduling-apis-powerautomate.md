---
title: Използване на API за график на проекта с Power Automate
description: Тази тема осигурява примерен поток, който използва програмните интерфейси на project schedule application (API).
author: ruhercul
ms.date: 01/26/2022
ms.topic: article
ms.reviewer: johnmichalak
ms.author: ruhercul
ms.openlocfilehash: 9708226b0955cfa6c405b9616c14765f9ebc21f7
ms.sourcegitcommit: c0792bd65d92db25e0e8864879a19c4b93efb10c
ms.translationtype: MT
ms.contentlocale: bg-BG
ms.lasthandoff: 04/14/2022
ms.locfileid: "8597693"
---
# <a name="use-project-schedule-apis-with-power-automate"></a>Използване на API за график на проекта с Power Automate

_**Отнася се за:** Project Operations за сценарии, базирани на ресурси / без складови наличности, внедряване на Lite - сделка с проформа фактуриране_

Тази тема описва примерен поток, който показва как да създадете пълен план на проект с помощта Microsoft Power Automate на, как да създадете набор операция и как да актуализирате обект. Примерът показва как да създадете проект, член на екипа на проекта, Operation Sets, проектни задачи и задания на ресурси. Тази тема обяснява също как да актуализирате обект и да изпълните набор от операции.

По-долу е пълен списък на стъпките, които са документирани в примерния поток в тази тема:

1. [Създаване на PowerApps спусък](#1)
2. [Създаване на проект](#2)
3. [Инициализиране на променлива за члена на екипа](#3)
4. [Създаване на общ член на екипа](#4)
5. [Създаване на набор от операции](#5)
6. [Създаване на кофа за проекти](#6)
7. [Инициализиране на променлива за състоянието на връзката](#7)
8. [Инициализиране на променлива за броя задачи](#8)
9. [Инициализиране на променлива за ИД на проектната задача](#9)
10. [Правете, докато](#10)
11. [Задаване на проектна задача](#11)
12. [Създаване на проектна задача](#12)
13. [Създаване на присвояване на ресурс](#13)
14. [Посценяване на променлива](#14)
15. [Преименуване на проектна задача](#15)
16. [Изпълнение на набор за операция](#16)

## <a name="assumptions"></a>Предположения

Тази тема предполага, че имате основни познания за Dataverse платформата, потоците в облака и интерфейса за програмиране на приложения на project Schedule (API). За повече информация вижте [раздела Препратки](#references) по-късно в тази тема.

## <a name="create-a-flow"></a>Създай поток

### <a name="select-an-environment"></a>Изберете среда

Можете да създадете потока Power Automate във вашата среда.

1. Отидете <https://flow.microsoft.com> в, и използвайте идентификационни данни на администратора си, за да влезете.
2. В горния десен ъгъл изберете **Среди**.
3. В списъка изберете средата, където Dynamics 365 Project Operations е инсталирана.

### <a name="create-a-solution"></a>Създаване на решение

Изпълнете следните стъпки, за да създадете поток [, осведомен за](/power-automate/overview-solution-flows) решения. Чрез създаването на поток, осведомен за решения, можете по-лесно да експортирате потока, за да го използвате по-късно.

1. В навигационния екран изберете **Решения**.
2. На **страницата Решения** изберете **Ново решение**.
3. В **диалоговия прозорец Ново решение** задайте необходимите полета и след това изберете **Създаване**.

## <a name="step-1-create-a-powerapps-trigger"></a><a id="1"></a> Стъпка 1: Създаване на PowerApps спусък

1. На **страницата Решения** изберете решението, което сте създали, след което изберете **Създай**.
2. В левия екран изберете **Облак потоци** \> **Автоматизация** \> **Облак поток** \> **Instant.**
3. В полето Име на **поток въведете** График API Демо поток **.**
4. В Изберете **как да задействате този списък с потоци** изберете **Power Apps**. Когато създавате Power Apps спусък, логиката е до вас като автор. В тази тема оставете входните параметри празни за целите на тестването.
5. Изберете **Създаване**.

## <a name="step-2-create-a-project"></a><a id="2"></a>Стъпка 2: Създаване на проект

Изпълнете следните стъпки, за да създадете примерен проект.

1. В потока, който сте създали, изберете **Нова стъпка**.

    ![Добавяне на нова стъпка.](media/newstep.png)

2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.

    ![Избор на операция.](media/chooseactiontab.png)

3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.

![Преименуване на стъпка.](media/renamestep.png)

4. Преименувайте стъпката **Създаване на проект**.
5. В полето Име **на** действие изберете **msdyn\_ CreateProjectV1**.
6. Под **полето за тема\_ msdyn** изберете **Добавяне на динамично съдържание**.
7. В раздела **Израз**, в полето за функция въведете **Име на проект - utcNow()**.
8. Изберете **OK**.

## <a name="step-3-initialize-a-variable-for-the-team-member"></a><a id="3"></a> Стъпка 3: Инициализиране на променлива за члена на екипа

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **инициализиране на променлива**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименувайте стъпката **Init член** на екипа.
5. В полето **Име** въведете **TeamMemberAction**.
6. В полето **Тип** изберете **Низ**.
7. В полето **Стойност** въведете **msdyn\_ СъздаванеTeamMemberV1**.

## <a name="step-4-create-a-generic-team-member"></a><a id="4"></a> Стъпка 4: Създаване на генеричен член на екипа

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпката **Създаване на член на** екипа.
5. За полето Име на **действие изберете** TeamMemberAction **в** диалоговия прозорец динамично съдържание **.**
6. В полето Параметри **на** действие въведете следната информация за параметъра.

    ```
    {
        "TeamMember": {
            "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projectteam",
            "msdyn_projectteamid": "@{guid()}",
            "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
            "msdyn_name": "ScheduleAPIDemoTM1"
        }
    } 
    ```

    Ето обяснение на параметрите:

    - **\@\@ odata.type** – Името на обекта. Например въведете **"Microsoft.Dynamics.CRM.msdyn\_ projectteam"**.
    - **msdyn\_ projectteamid** – Основният ключ на иД на екипа по проекта. Стойността е глобално уникален идентификатор (GUID) израз.   Идентификаторът се генерира от раздела за изразяване.

    - **msdyn\_ проект\@ odata.bind** – ИД на проекта на проекта за притежаване. Стойността ще бъде динамично съдържание, което идва от отговора на стъпката "Създаване на проект". Уверете се, че въвеждате пълния път и добавяте динамично съдържание между скобите. Необходими са кавички. Въведете например **"/msdyn\_ проекти(ДОБАВЯНЕ на динамично съдържание)".**
    - **име\_ на MSDYN**– Името на члена на екипа. Въведете например **"ScheduleAPIDemoTM1".**

## <a name="step-5-create-an-operation-set"></a><a id="5"></a> Стъпка 5: Създаване на набор за операция

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпката **Създаване на набор** от операции.
5. В полето Име на действие изберете персонализираното действие msdyn **CreateOperationSetV1** **\_.** Dataverse
6. В полето **Описание** въведете **ScheduleAPIDemoOperationSet**.
7. В полето **Проект** въведете **/msdyn\_ проекти(**.
8. В **диалоговия прозорец динамично съдържание** изберете **msdyn\_ CreateProjectV1Response ProjectId**.
9. В полето **Проект** въведете **)**.

## <a name="step-6-create-a-project-bucket"></a><a id="6"></a> Стъпка 6: Създаване на кофа за проекти

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция**, в полето за търсене въведете **добавяне на нов ред**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименувайте стъпката **Създаване на кофа**.
5. В полето Име **на** таблица изберете **Проект кофи**.
6. В полето **Име** въведете **ScheduleAPIDemoBucket1**.
7. За полето **Проект** изберете **msdyn\_ CreateProjectV1Response ProjectId** в **диалоговия прозорец динамично съдържание**.

## <a name="step-7-initialize-a-variable-for-the-link-status"></a><a id="7"></a> Стъпка 7: Инициализиране на променлива за състоянието на връзката

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **инициализиране на променлива**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименувайте стъпката **Init linkstatus**.
5. В полето **Име** въведете **връзкастатус**.
6. В полето **Тип** изберете **Цяло число**.
7. В полето **Стойност** въведете **192350000**.

## <a name="step-8-initialize-a-variable-for-the-number-of-tasks"></a><a id="8"></a> Стъпка 8: Инициализиране на променлива за броя задачи

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **инициализиране на променлива**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпката **Init Брой задачи**.
5. В полето **Име** въведете **брой задачи**.
6. В полето **Тип** изберете **Цяло число**.
7. В полето **Стойност** въведете **5**.

## <a name="step-9-initialize-a-variable-for-the-project-task-id"></a><a id="9"></a> Стъпка 9: Инициализиране на променлива за ИД на проектната задача

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **инициализиране на променлива**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпката **Init ProjectTaskID**.
5. В полето **Име** въведете **брой задачи**.
6. В полето **Тип** изберете **Низ**.
7. За полето **Стойност** въведете **guid()** в конструктора на изрази.

## <a name="step-10-do-until"></a><a id="10"></a> Стъпка 10: Направете, докато

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция**, в полето за търсене въведете **направете, докато**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. Задайте първата стойност в условната декларация на **броя задачи** променлива от **диалоговия прозорец динамично съдържание**.
4. Задайте условието на **по-малко от равно на**.
5. Задайте втората стойност в условното извлечение на **0**.

## <a name="step-11-set-a-project-task"></a><a id="11"></a> Стъпка 11: Задаване на проектна задача

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **зададена променлива**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В новата стъпка изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпката **Задаване на проект задача**.
5. В полето **Име** изберете **msdyn\_ projecttaskid**.
6. За полето **Стойност** въведете **guid()** в конструктора на изрази.

## <a name="step-12-create-a-project-task"></a><a id="12"></a> Стъпка 12: Създаване на проектна задача

Изпълнете следните стъпки, за да създадете проектна задача, която има уникален ИД, който принадлежи към текущия проект и кофата на проекта, която сте създали.

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В стъпката изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименувайте стъпката **Създаване на проект задача**.
5. В полето Име **на** действие изберете **msdyn\_ PssCreateV1**.
6. В полето **Обект** въведете следната информация за параметъра.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
        "msdyn_subject": "ScheduleAPIDemoTask1",
        "msdyn_projectbucket@odata.bind": "/msdyn_projectbuckets(@{outputs('Create_Project_Buckets')?['body/msdyn_projectbucketid']})",
        "msdyn_start": "@{addDays(utcNow(), 1)}",
        "msdyn_scheduledstart": "@{utcNow()}",
        "msdyn_scheduledend": "@{addDays(utcNow(), 5)}",
        "msdyn_LinkStatus": "192350000"
    }
    ```

    Ето обяснение на параметрите:

    - **\@\@ odata.type** – Името на обекта. Например въведете **"Microsoft.Dynamics.CRM.msdyn\_ проектна работа".**
    - **msdyn\_ projecttaskid** – Уникалният ИД на задачата. Стойността трябва да бъде зададена на динамична променлива от **msdyn\_ projecttaskid**.
    - **msdyn\_ проект\@ odata.bind** – ИД на проекта на проекта за притежаване. Стойността ще бъде динамично съдържание, което идва от отговора на стъпката "Създаване на проект". Уверете се, че въвеждате пълния път и добавяте динамично съдържание между скобите. Необходими са кавички. Въведете например **"/msdyn\_ проекти(ДОБАВЯНЕ на динамично съдържание)".**
    - **msdyn\_ тема** – Всяко име на задача.
    - **msdyn\_ projectbucket\@ odata.bind** – Кофата на проекта, която съдържа задачите. Стойността ще бъде динамично съдържание, което идва от отговора на стъпката "Създаване на кофа". Уверете се, че въвеждате пълния път и добавяте динамично съдържание между скобите. Необходими са кавички. Въведете например **"/msdyn\_ projectbuckets(ДОБАВЯНЕ на динамично съдържание)".**
    - **стартиране\_ на MSDYN**– Динамично съдържание за началната дата. Например, утре ще бъде представена като **"addDays(utcNow(), 1)"**.
    - **msdyn\_ scheduledstart** – Планираната начална дата. Например, утре ще бъде представена като **"addDays(utcNow(), 1)"**.
    - **msdyn\_ графикенд** – Планираната крайна дата. Изберете дата в бъдеще. Например задайте **"addDays(utcNow(), 5)"**.
    - **msdyn\_ LinkStatus** – Състоянието на връзката. Въведете например **"192350000".**

7. За полето OperationSetId **изберете** msdyn **CreateOperationSetV1Response\_ в** диалоговия прозорец динамично съдържание **.**

## <a name="step-13-create-a-resource-assignment"></a><a id="13"></a> Стъпка 13: Създаване на присвояване на ресурс

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В стъпката изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименувайте стъпката **Създаване на присвояване**.
5. В полето Име **на** действие изберете **msdyn\_ PssCreateV1**.
6. В полето **Обект** въведете следната информация за параметъра.

    ```
    {
        "@odata.type": "Microsoft.Dynamics.CRM.msdyn_resourceassignment",
        "msdyn_resourceassignmentid": "@{guid()}",
        "msdyn_name": "ScheduleAPIDemoAssign1",
        "msdyn_taskid@odata.bind": "/msdyn_projecttasks(@{variables('msdyn_projecttaskid')})",
        "msdyn_projectteamid@odata.bind": "/msdyn_projectteams(@{outputs('Create_Team_Member')?['body/TeamMemberId']})",
        "msdyn_projectid@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})"
    }
    ```

7. За полето OperationSetId **изберете** msdyn **CreateOperationSetV1Response\_ в** диалоговия прозорец динамично съдържание **.**

## <a name="step-14-decrement-a-variable"></a><a id="14"></a> Стъпка 14: Определяне на променлива

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция**, в полето за търсене въведете **променлива** на декремент. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В полето **Име** изберете **брой задачи**.
4. В полето **Стойност** въведете **1**.

## <a name="step-15-rename-a-project-task"></a><a id="15"></a> Стъпка 15: Преименуване на проектна задача

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В стъпката изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпката **Преименуване на проект задача**.
5. В полето Име **на** действие изберете **msdyn\_ PssUpdateV1**.
6. В полето **Обект** въведете следната информация за параметъра.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_subject": "ScheduleDemoTask1-UpdatedName"
    }
    ```

7. За полето OperationSetId **изберете** msdyn **CreateOperationSetV1Response\_ в** диалоговия прозорец динамично съдържание **.**

## <a name="step-16-run-an-operation-set"></a><a id="16"></a> Стъпка 16: Изпълнете набор операция

1. В потока изберете **Нова стъпка**.
2. В диалоговия прозорец Избор на **операция** в полето за търсене въведете **извършване на необвързано действие**. След това в раздела **Действия** изберете операцията в списъка с резултати.
3. В стъпката изберете елипсата (**...**), след което изберете **Преименуване**.
4. Преименуване на стъпка **изпълни операция набор**.
5. В полето Име **на** действие изберете **msdyn\_ ExecuteOperationSetV1**.
6. За полето OperationSetId **изберете** msdyn **CreateOperationSetV1Response OperationSetId\_ в диалоговия прозорец на съдържанието** на **Dynamid**.

## <a name="references"></a>Препратки

- [Преглед на начина за интегриране на потоците с Dataverse - Power Automate](/power-automate/dataverse/overview?WT.mc_id=email)
- [Използвайте API за график на проекти, за да извършвате операции с обекти за планиране](schedule-api-preview.md)
- [Преглед на облачните потоци - Power Automate](/power-automate/overview-cloud?WT.mc_id=email)
- [Преглед на потоците, осведомени за решения - Power Automate](/power-automate/overview-solution-flows?WT.mc_id=email)
