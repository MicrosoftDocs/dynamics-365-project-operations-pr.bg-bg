---
title: Проформа фактури по проект
description: Тази тема предоставя информация за проформа фактури за проекти в Project Operations.
author: rumant
ms.date: 04/06/2021
ms.topic: article
ms.prod: ''
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 1b839c3e40ddcfe1f07b0330a78c42851140d4bf
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: bg-BG
ms.lasthandoff: 05/10/2021
ms.locfileid: "6004023"
---
# <a name="proforma-project-pnvoices"></a><span data-ttu-id="cda24-103">Проформа фактури по проект</span><span class="sxs-lookup"><span data-stu-id="cda24-103">Proforma project pnvoices</span></span>

<span data-ttu-id="cda24-104">_**Прилага се за:** Леко внедряване – фактуриране на сделката към проформа_</span><span class="sxs-lookup"><span data-stu-id="cda24-104">_**Applies To:** Lite deployment - deal to proforma invoicing_</span></span>

<span data-ttu-id="cda24-105">Фактурирането на проект проформа дава на мениджърите на проекти второ ниво на одобрение, преди да създадат фактури за клиенти.</span><span class="sxs-lookup"><span data-stu-id="cda24-105">Proforma project invoicing gives project managers a second level of approval before they create invoices for customers.</span></span> <span data-ttu-id="cda24-106">Първото ниво на одобрение се попълва, когато се одобрят записите за часа, разходите и материалите, които членовете на екипа по проекта подават.</span><span class="sxs-lookup"><span data-stu-id="cda24-106">The first level of approval is completed when time, expense, and material entries that project team members submit are approved.</span></span>

<span data-ttu-id="cda24-107">Dynamics 365 Project Operations Lite Deployment не е предназначен за генериране на фактури, ориентирани към клиентите.</span><span class="sxs-lookup"><span data-stu-id="cda24-107">Dynamics 365 Project Operations Lite Deployment isn't designed to generate customer-facing invoices.</span></span> <span data-ttu-id="cda24-108">Следният списък показва защо фактурите не могат да бъдат генерирани:</span><span class="sxs-lookup"><span data-stu-id="cda24-108">The following list shows why invoices cannot be generated:</span></span>

- <span data-ttu-id="cda24-109">Не съдържа данъчна информация.</span><span class="sxs-lookup"><span data-stu-id="cda24-109">Does not contain tax information.</span></span>
- <span data-ttu-id="cda24-110">Не можете да конвертирате други валути във валутата за фактуриране.</span><span class="sxs-lookup"><span data-stu-id="cda24-110">Cannot convert other currencies to the invoicing currency.</span></span>
- <span data-ttu-id="cda24-111">Не може да форматира правилно фактурите за печат.</span><span class="sxs-lookup"><span data-stu-id="cda24-111">Cannot correctly format invoices for printing.</span></span>

<span data-ttu-id="cda24-112">Вместо това можете да използвате финансова или счетоводна система за създаване на фактури за клиенти, които използват информацията в генерирани предложения за фактуриране.</span><span class="sxs-lookup"><span data-stu-id="cda24-112">Instead, you can use a financial or accounting system to create customer-facing invoices that use the information in generated invoice proposals.</span></span>

## <a name="creating-project-invoices"></a><span data-ttu-id="cda24-113">Създаване на фактури за проект</span><span class="sxs-lookup"><span data-stu-id="cda24-113">Creating project invoices</span></span>

<span data-ttu-id="cda24-114">Фактурите по проект могат да бъдат създавани индивидуално или групово.</span><span class="sxs-lookup"><span data-stu-id="cda24-114">Project invoices can be created one at a time or in bulk.</span></span> <span data-ttu-id="cda24-115">Можете да ги създавате ръчно или да ги конфигурирате да се генерират в автоматизирани цикли.</span><span class="sxs-lookup"><span data-stu-id="cda24-115">You can create them manually, or they can be configured so that they are generated in automated runs.</span></span>

### <a name="manually-create-project-invoices"></a><span data-ttu-id="cda24-116">Ръчно създаване на фактури по проект</span><span class="sxs-lookup"><span data-stu-id="cda24-116">Manually create project invoices</span></span> 

<span data-ttu-id="cda24-117">На страницата със списъка **Договори по проекти** можете да създавате фактури по проекти поотделно за всеки договор по проект или групово за няколко договора по проекти.</span><span class="sxs-lookup"><span data-stu-id="cda24-117">On the **Project Contracts** list page, you can create project invoices separately for each project contract, or you can create invoices in bulk for multiple project contracts.</span></span>

   - <span data-ttu-id="cda24-118">За да създадете фактура за определен договор по проект, на страницата със списъка **Договори по проекти** отворете договор по проект, след което изберете **Създаване на фактура**.</span><span class="sxs-lookup"><span data-stu-id="cda24-118">To create an invoice for a specific project contract, on the **Project Contracts** list page, open a project contract, and then select **Create Invoice**.</span></span>

   <span data-ttu-id="cda24-119">Генерира се фактура за всички транзакции за избрания договор по проект, които имат състояние **Готово за фактуриране**.</span><span class="sxs-lookup"><span data-stu-id="cda24-119">An invoice is generated for all transactions for the selected project contract that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="cda24-120">Тези транзакции включват време, разходи, материали, етапи, базирани на продукти договорни редове и други нефактулирани редове от дневника за продажби, които може да са били потвърдени.</span><span class="sxs-lookup"><span data-stu-id="cda24-120">These transactions include time, expenses, materials, milestones, product-based contract lines, and other unbilled sales journal lines that may have been confirmed.</span></span>

<span data-ttu-id="cda24-121">За да създадете фактури групово:</span><span class="sxs-lookup"><span data-stu-id="cda24-121">To create invoices in bulk:</span></span>

1. <span data-ttu-id="cda24-122">На страницата със списъка **Договори по проекти** изберете един или повече договори по проекти, за които трябва да създадете фактура, след което изберете **Създаване на фактури за проект**.</span><span class="sxs-lookup"><span data-stu-id="cda24-122">On the **Project Contracts** list page, select one or more project contracts to create an invoice for, and then select **Create Project Invoices**.</span></span>
2. <span data-ttu-id="cda24-123">Предупредително съобщение ви информира, че може да има закъснение, преди да бъдат създадени фактурите.</span><span class="sxs-lookup"><span data-stu-id="cda24-123">A warning message informs you that there might be a delay before invoices are created.</span></span> <span data-ttu-id="cda24-124">Процесът също е показан.</span><span class="sxs-lookup"><span data-stu-id="cda24-124">The process is also shown.</span></span> <span data-ttu-id="cda24-125">Изберете **ОК**, за да затворите прозореца на съобщението.</span><span class="sxs-lookup"><span data-stu-id="cda24-125">Select **OK** to close the message box.</span></span>

   <span data-ttu-id="cda24-126">Генерира се фактура за всички транзакции в ред на договор, които имат състояние **Готово за фактуриране**.</span><span class="sxs-lookup"><span data-stu-id="cda24-126">An invoice is generated for all transactions on a contract line that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="cda24-127">Тези транзакции включват време, разходи, материали, етапи, базирани на продукти договорни редове и други нефактурирани редове от дневника за продажби, които може да са били потвърдени.</span><span class="sxs-lookup"><span data-stu-id="cda24-127">These transactions include time, expenses, materials, milestones, product - based contract lines and other unbilled sales journal lines that may have been confirmed.</span></span>

3. <span data-ttu-id="cda24-128">Прегледайте генерираните фактури, като отидете на **Продажби** \> **Фактуриране** \> **Фактури**.</span><span class="sxs-lookup"><span data-stu-id="cda24-128">View the invoices that are generated by going to **Sales** \> **Billing** \> **Invoices**.</span></span> <span data-ttu-id="cda24-129">Ще видите една фактура за всеки договор по проект.</span><span class="sxs-lookup"><span data-stu-id="cda24-129">You will see one invoice for each project contract.</span></span>

### <a name="set-up-automated-creation-of-project-invoices"></a><span data-ttu-id="cda24-130">Настройване на автоматизирано създаване на фактури за проект</span><span class="sxs-lookup"><span data-stu-id="cda24-130">Set up automated creation of project invoices</span></span> 

<span data-ttu-id="cda24-131">Изпълнете следните стъпки, за да конфигурирате автоматичен цикъл на фактуриране.</span><span class="sxs-lookup"><span data-stu-id="cda24-131">Follow these steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="cda24-132">Отидете в **Настройки** \> **Пакетни задания**.</span><span class="sxs-lookup"><span data-stu-id="cda24-132">Go to **Settings** \> **Batch jobs**.</span></span>
2. <span data-ttu-id="cda24-133">Създайте пакетно задание и го наименувайте **Създаване на фактури в Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="cda24-133">Create a batch job, and name it **Project Operations Create Invoices**.</span></span> <span data-ttu-id="cda24-134">Името на пакетното задание трябва да включва термина „създаване на фактури“.</span><span class="sxs-lookup"><span data-stu-id="cda24-134">The name of the batch job must include the term "Create Invoices."</span></span>
3. <span data-ttu-id="cda24-135">В полето **Тип задание** изберете **Няма**.</span><span class="sxs-lookup"><span data-stu-id="cda24-135">In the **Job type** field, select **None**.</span></span> <span data-ttu-id="cda24-136">По подразбиране опциите **Честота дневно** и **Е активно** са зададени на **Да**.</span><span class="sxs-lookup"><span data-stu-id="cda24-136">By default, the **Frequency Daily** and **Is Active** options are set to **Yes**.</span></span>
4. <span data-ttu-id="cda24-137">Изберете **Стартиране на работен поток**.</span><span class="sxs-lookup"><span data-stu-id="cda24-137">Select **Run Workflow**.</span></span> <span data-ttu-id="cda24-138">В диалоговия прозорец **Търсене на запис** ще видите следните работни потоци:</span><span class="sxs-lookup"><span data-stu-id="cda24-138">In the **Look Up Record** dialog box, you will see the following workflows:</span></span>

    - <span data-ttu-id="cda24-139">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="cda24-139">ProcessRunCaller</span></span>
    - <span data-ttu-id="cda24-140">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="cda24-140">ProcessRunner</span></span>
    - <span data-ttu-id="cda24-141">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="cda24-141">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="cda24-142">Изберете **ProcessRunCaller** и след това **Добавяне**.</span><span class="sxs-lookup"><span data-stu-id="cda24-142">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="cda24-143">В следващия диалогов прозорец изберете **OK**.</span><span class="sxs-lookup"><span data-stu-id="cda24-143">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="cda24-144">Работен поток **Заспиване** е последван от работен поток **Обработване**.</span><span class="sxs-lookup"><span data-stu-id="cda24-144">A **Sleep** workflow is followed by a **Process** workflow.</span></span>

    <span data-ttu-id="cda24-145">Можете също да изберете **ProcessRunner** в стъпка 5.</span><span class="sxs-lookup"><span data-stu-id="cda24-145">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="cda24-146">След това, когато изберете **OK**, работният поток **Обработка** е последван от работен поток **Заспиване**.</span><span class="sxs-lookup"><span data-stu-id="cda24-146">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="cda24-147">Работните потоци **ProcessRunCaller** и **ProcessRunner** създават фактури.</span><span class="sxs-lookup"><span data-stu-id="cda24-147">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="cda24-148">**ProcessRunCaller** извиква **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="cda24-148">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="cda24-149">**ProcessRunner** е работният поток, който създава фактурите.</span><span class="sxs-lookup"><span data-stu-id="cda24-149">**ProcessRunner** is the workflow that creates the invoices.</span></span> <span data-ttu-id="cda24-150">Този работен поток преминава през всички редове на договора, за които трябва да бъдат създадени фактури, и създава фактурите.</span><span class="sxs-lookup"><span data-stu-id="cda24-150">This workflow goes through all the contract lines that invoices must be created for, and creates the invoices.</span></span> <span data-ttu-id="cda24-151">За да определи редовете на договора, за които трябва да бъдат създадени фактури, работният поток търси в датите на изпълнение на фактурите за редовете на договора.</span><span class="sxs-lookup"><span data-stu-id="cda24-151">To determine the contract lines that invoices must be created for, the workflow looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="cda24-152">Ако редове на договор, които принадлежат към един договор, имат една и съща дата на изпълнение на фактура, транзакциите се комбинират в една фактура, която има два реда.</span><span class="sxs-lookup"><span data-stu-id="cda24-152">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="cda24-153">Ако няма транзакции, за които да бъдат създадени фактури, не се създават фактури.</span><span class="sxs-lookup"><span data-stu-id="cda24-153">If there are no transactions to create invoices for, no invoices are created.</span></span>

<span data-ttu-id="cda24-154">След като **ProcessRunner** завърши изпълнението на цикъла, той извиква **ProcessRunCaller**, дава крайния час, и се затваря.</span><span class="sxs-lookup"><span data-stu-id="cda24-154">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="cda24-155">**ProcessRunCaller** след това стартира таймер, който работи в продължение на 24 часа от посочения краен час.</span><span class="sxs-lookup"><span data-stu-id="cda24-155">**ProcessRunCaller** then starts a timer that runs for 24 hours from the specified end time.</span></span> <span data-ttu-id="cda24-156">В края на таймера **ProcessRunCaller** се затваря.</span><span class="sxs-lookup"><span data-stu-id="cda24-156">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="cda24-157">Заданието за пакетно обработване за създаване на фактури е повтарящо се задание.</span><span class="sxs-lookup"><span data-stu-id="cda24-157">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="cda24-158">Ако това пакетно обработване се изпълнява много пъти, се създават няколко екземпляра на заданието и могат да причинят грешки.</span><span class="sxs-lookup"><span data-stu-id="cda24-158">If this batch process is run many times, multiple instances of the job are created and can cause errors.</span></span> <span data-ttu-id="cda24-159">За да заобиколите този проблем, трябва да стартирате пакетното обработване само един път и трябва да го рестартирате само ако спре да работи.</span><span class="sxs-lookup"><span data-stu-id="cda24-159">To work around this issue, start the batch process only one time, and only restart it if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="cda24-160">Партидното фактуриране се изпълнява само за линиите на договор за проект, които са конфигурирани от графици за фактури.</span><span class="sxs-lookup"><span data-stu-id="cda24-160">Batch invoicing only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="cda24-161">Аспекти на договор с метод на фактуриране по фиксирана цена трябва да имат конфигурирани контролни точки.</span><span class="sxs-lookup"><span data-stu-id="cda24-161">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="cda24-162">Аспекти на договор по проект с метод на фактуриране по време и материали ще се нуждаят от зададен график за фактуриране, базиран на дата.</span><span class="sxs-lookup"><span data-stu-id="cda24-162">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span> <span data-ttu-id="cda24-163">Същото се отнася и за аспекти на договор, базирани на проект.</span><span class="sxs-lookup"><span data-stu-id="cda24-163">The same applies to a project-based contract line.</span></span>      
 
### <a name="edit-a-draft-invoice"></a><span data-ttu-id="cda24-164">Редактиране на чернова на фактура</span><span class="sxs-lookup"><span data-stu-id="cda24-164">Edit a draft invoice</span></span>

<span data-ttu-id="cda24-165">Когато създавате чернова на фактура по проект, всички нефактурирани продажбени транзакции, които са създадени, когато са одобрени записите за време и разходи, се изтеглят във фактурата.</span><span class="sxs-lookup"><span data-stu-id="cda24-165">When you create a draft project invoice, all unbilled sales transactions that were created when the time and expense entries were approved are pulled onto the invoice.</span></span> <span data-ttu-id="cda24-166">Можете да направите следните корекции, докато фактурата все още е в етап на чернова:</span><span class="sxs-lookup"><span data-stu-id="cda24-166">You can make the following adjustments while the invoice is still in a draft stage:</span></span>

- <span data-ttu-id="cda24-167">Изтриване или редактиране на подробностите за ред на фактурата.</span><span class="sxs-lookup"><span data-stu-id="cda24-167">Delete or edit invoice line details.</span></span>
- <span data-ttu-id="cda24-168">Редактиране и коригиране на количеството и типа фактуриране.</span><span class="sxs-lookup"><span data-stu-id="cda24-168">Edit and adjust the quantity and billing type.</span></span>
- <span data-ttu-id="cda24-169">Директно добавяне на време, разходи, материали и такси като транзакции във фактурата.</span><span class="sxs-lookup"><span data-stu-id="cda24-169">Directly add time, expense, material, and fees as transactions on the invoice.</span></span> <span data-ttu-id="cda24-170">Можете да използвате тази функция, ако редът от фактурата се съпоставя към ред на договор, който позволява тези класове транзакции.</span><span class="sxs-lookup"><span data-stu-id="cda24-170">You can use this feature if the invoice line is mapped to a contract line that allows for these transaction classes.</span></span>

<span data-ttu-id="cda24-171">Изберете **Потвърждаване**, за да потвърдите фактура.</span><span class="sxs-lookup"><span data-stu-id="cda24-171">Select **Confirm** to confirm an invoice.</span></span> <span data-ttu-id="cda24-172">Това действие е еднопосочно.</span><span class="sxs-lookup"><span data-stu-id="cda24-172">This action is a one-way action.</span></span> <span data-ttu-id="cda24-173">Когато изберете **Потвърждаване**, фактурата става само за четене и създава фактурирани действителни продажби от всяка подробност за ред на фактурата за всеки ред на фактурата.</span><span class="sxs-lookup"><span data-stu-id="cda24-173">When you select **Confirm**, the invoice becomes read only and creates billed sales actuals from each invoice line detail for each invoice line.</span></span> <span data-ttu-id="cda24-174">Ако подробностите за реда на фактурата се позовават на нефактурирана действителна продажба, нефактурираната действителна продажба се сторнира.</span><span class="sxs-lookup"><span data-stu-id="cda24-174">If the invoice line detail references an unbilled sales actual, the unbilled sales actual is reversed.</span></span> <span data-ttu-id="cda24-175">Всеки детайл на реда за фактура, който е създаден от запис за време, разход или използване на материали, ще се позовава на действително нефактурирани продажби.</span><span class="sxs-lookup"><span data-stu-id="cda24-175">Any invoice line detail that was created from a time, expense, or material usage entry will reference an unbilled sales actual.</span></span> <span data-ttu-id="cda24-176">Системите за интеграция на главната книга могат да използват това обръщане, за да обърнат незавършената незавършена работа по проекта (WIP) за счетоводни цели.</span><span class="sxs-lookup"><span data-stu-id="cda24-176">General ledger integration systems can use this reversal to reverse project work in progress (WIP) for accounting purposes.</span></span>

### <a name="correct-a-confirmed-invoice"></a><span data-ttu-id="cda24-177">Коригиране на потвърдена фактура</span><span class="sxs-lookup"><span data-stu-id="cda24-177">Correct a confirmed invoice</span></span>

<span data-ttu-id="cda24-178">Потвърдени фактури могат да бъдат редактирани.</span><span class="sxs-lookup"><span data-stu-id="cda24-178">Confirmed invoices can be edited.</span></span> <span data-ttu-id="cda24-179">Когато коригирате потвърдена фактура, се създава нова чернова на коригираща фактура.</span><span class="sxs-lookup"><span data-stu-id="cda24-179">When you correct a confirmed invoice, a new draft corrective invoice is created.</span></span> <span data-ttu-id="cda24-180">Тъй като се предполага, че искате да сторнирате всички транзакции и количества от първоначалната фактура, тази коригираща фактура включва всички транзакции от оригиналната фактура и всички количества в нея са нула.</span><span class="sxs-lookup"><span data-stu-id="cda24-180">Because the assumption is that you want to reverse all the transactions and quantities from the original invoice, this corrective invoice includes all the transactions from the original invoice, and all the quantities on it are zero.</span></span>

<span data-ttu-id="cda24-181">Ако има транзакции, които не изискват корекция, можете да ги премахнете от черновата на коригираща фактура.</span><span class="sxs-lookup"><span data-stu-id="cda24-181">If there are transactions that don't require correction, you can remove them from the draft corrective invoice.</span></span> <span data-ttu-id="cda24-182">Ако искате да сторнирате или да върнете само частично количество, можете да редактирате полето **Количество** в подробностите за реда.</span><span class="sxs-lookup"><span data-stu-id="cda24-182">If you want to reverse or return only a partial quantity, you can edit the **Quantity** field on the line detail.</span></span> <span data-ttu-id="cda24-183">Ако отворите подробностите за реда на фактурата, можете да видите количеството в първоначалната фактура.</span><span class="sxs-lookup"><span data-stu-id="cda24-183">If you open the invoice line detail, you can see the original invoice quantity.</span></span> <span data-ttu-id="cda24-184">След това можете да редактирате количеството в текущата фактура, така че да е по-малко или повече от количеството в първоначалната фактура.</span><span class="sxs-lookup"><span data-stu-id="cda24-184">You can then edit the current invoice quantity so that it's less than or more than the original invoice quantity.</span></span>

<span data-ttu-id="cda24-185">Когато потвърдите коригираща фактура, първоначално фактурираните действителни продажби се сторнират и се създават нови фактурирани действителни продажби.</span><span class="sxs-lookup"><span data-stu-id="cda24-185">When you confirm a corrective invoice, the original billed sales actual is reversed, and a new billed sales actual is created.</span></span> <span data-ttu-id="cda24-186">Ако количеството е било намалено, разликата ще доведе до създаването и на нова нефактурирана действителна продажба.</span><span class="sxs-lookup"><span data-stu-id="cda24-186">If the quantity was reduced, the difference will cause a new unbilled sales actual to be created.</span></span> <span data-ttu-id="cda24-187">Например, ако първоначалната фактурирана продажба са били за осем часа, а подробностите на реда на коригиращата фактура имат намалено количество от шест часа, редът на първоначално фактурираната продажба се сторнира и създава две нови действителни данни:</span><span class="sxs-lookup"><span data-stu-id="cda24-187">For example, if the original billed sale was for eight hours and the corrective invoice line detail has a reduced quantity of six hours, the original billed sales line is reversed and two new actuals are created:</span></span>

- <span data-ttu-id="cda24-188">фактурирана действителна продажба за шест часа.</span><span class="sxs-lookup"><span data-stu-id="cda24-188">A billed sales actual for six hours.</span></span>
- <span data-ttu-id="cda24-189">нефактурирана действителна продажба за оставащите два часа.</span><span class="sxs-lookup"><span data-stu-id="cda24-189">An unbilled sales actual for the remaining two hours.</span></span> <span data-ttu-id="cda24-190">Тази транзакция може да бъде фактурирана по-късно или отбелязана като неплатима, в зависимост от договорките с клиента.</span><span class="sxs-lookup"><span data-stu-id="cda24-190">This transaction can be billed later or marked as non-chargeable, depending on the negotiations with the customer.</span></span>



[!INCLUDE[footer-include](../../includes/footer-banner.md)]
