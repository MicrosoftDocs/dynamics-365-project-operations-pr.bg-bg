---
title: Проформа фактури по проект
description: Тази тема предоставя информация за проформа фактури за проекти в Project Operations.
author: rumant
ms.date: 04/06/2021
ms.topic: article
ms.prod: ''
ms.reviewer: johnmichalak
ms.author: rumant
ms.openlocfilehash: f2ce672a412f7ad73b072854590cd423a3499fc1
ms.sourcegitcommit: 650a84add65588defdd2ac2c4524806baab070e0
ms.translationtype: MT
ms.contentlocale: bg-BG
ms.lasthandoff: 04/21/2022
ms.locfileid: "8628841"
---
# <a name="proforma-project-invoices"></a>Проформа фактури по проект

_**Прилага се за:** Леко внедряване – фактуриране на сделката към проформа_

Фактурирането на проект проформа дава на мениджърите на проекти второ ниво на одобрение, преди да създадат фактури за клиенти. Първото ниво на одобрение се попълва, когато се одобрят записите за часа, разходите и материалите, които членовете на екипа по проекта подават.

Dynamics 365 Project Operations Lite Deployment не е предназначен за генериране на фактури, ориентирани към клиентите. Следният списък показва защо фактурите не могат да бъдат генерирани:

- Не съдържа данъчна информация.
- Не можете да конвертирате други валути във валутата за фактуриране.
- Не може да форматира правилно фактурите за печат.

Вместо това можете да използвате финансова или счетоводна система за създаване на фактури за клиенти, които използват информацията в генерирани предложения за фактуриране.

## <a name="creating-project-invoices"></a>Създаване на фактури за проект

Фактурите по проект могат да бъдат създавани индивидуално или групово. Можете да ги създавате ръчно или да ги конфигурирате да се генерират в автоматизирани цикли.

### <a name="manually-create-project-invoices"></a>Ръчно създаване на фактури по проект 

На страницата със списъка **Договори по проекти** можете да създавате фактури по проекти поотделно за всеки договор по проект или групово за няколко договора по проекти.

   - За да създадете фактура за определен договор по проект, на страницата със списъка **Договори по проекти** отворете договор по проект, след което изберете **Създаване на фактура**.

   Генерира се фактура за всички транзакции за избрания договор по проект, които имат състояние **Готово за фактуриране**. Тези транзакции включват време, разходи, материали, етапи, базирани на продукти договорни редове и други нефактулирани редове от дневника за продажби, които може да са били потвърдени.

За да създадете фактури групово:

1. На страницата със списъка **Договори по проекти** изберете един или повече договори по проекти, за които трябва да създадете фактура, след което изберете **Създаване на фактури за проект**.
2. Предупредително съобщение ви информира, че може да има закъснение, преди да бъдат създадени фактурите. Процесът също е показан. Изберете **ОК**, за да затворите прозореца на съобщението.

   Генерира се фактура за всички транзакции в ред на договор, които имат състояние **Готово за фактуриране**. Тези транзакции включват време, разходи, материали, етапи, базирани на продукти договорни редове и други нефактурирани редове от дневника за продажби, които може да са били потвърдени.

3. Прегледайте генерираните фактури, като отидете на **Продажби** \> **Фактуриране** \> **Фактури**. Ще видите една фактура за всеки договор по проект.

### <a name="set-up-automated-creation-of-project-invoices"></a>Настройване на автоматизирано създаване на фактури за проект 

Изпълнете следните стъпки, за да конфигурирате автоматичен цикъл на фактуриране.

1. Отидете в **Настройки** \> **Пакетни задания**.
2. Създайте пакетно задание и го наименувайте **Създаване на фактури в Project Operations**. Името на пакетното задание трябва да включва термина „създаване на фактури“.
3. В полето **Тип задание** изберете **Няма**. По подразбиране опциите **Честота дневно** и **Е активно** са зададени на **Да**.
4. Изберете **Стартиране на работен поток**. В диалоговия прозорец **Търсене на запис** ще видите следните работни потоци:

    - ProcessRunCaller
    - ProcessRunner
    - UpdateRoleUtilization

5. Изберете **ProcessRunCaller** и след това **Добавяне**.
6. В следващия диалогов прозорец изберете **OK**. Работен поток **Заспиване** е последван от работен поток **Обработване**.

    Можете също да изберете **ProcessRunner** в стъпка 5. След това, когато изберете **OK**, работният поток **Обработка** е последван от работен поток **Заспиване**.

Работните потоци **ProcessRunCaller** и **ProcessRunner** създават фактури. **ProcessRunCaller** извиква **ProcessRunner**. **ProcessRunner** е работният поток, който създава фактурите. Този работен поток преминава през всички редове на договора, за които трябва да бъдат създадени фактури, и създава фактурите. За да определи редовете на договора, за които трябва да бъдат създадени фактури, работният поток търси в датите на изпълнение на фактурите за редовете на договора. Ако редове на договор, които принадлежат към един договор, имат една и съща дата на изпълнение на фактура, транзакциите се комбинират в една фактура, която има два реда. Ако няма транзакции, за които да бъдат създадени фактури, не се създават фактури.

След като **ProcessRunner** завърши изпълнението на цикъла, той извиква **ProcessRunCaller**, дава крайния час, и се затваря. **ProcessRunCaller** след това стартира таймер, който работи в продължение на 24 часа от посочения краен час. В края на таймера **ProcessRunCaller** се затваря.

Заданието за пакетно обработване за създаване на фактури е повтарящо се задание. Ако това пакетно обработване се изпълнява много пъти, се създават няколко екземпляра на заданието и могат да причинят грешки. За да заобиколите този проблем, трябва да стартирате пакетното обработване само един път и трябва да го рестартирате само ако спре да работи.

> [!NOTE]
> Партидното фактуриране се изпълнява само за линиите на договор за проект, които са конфигурирани от графици за фактури. Аспекти на договор с метод на фактуриране по фиксирана цена трябва да имат конфигурирани контролни точки. Аспекти на договор по проект с метод на фактуриране по време и материали ще се нуждаят от зададен график за фактуриране, базиран на дата. Същото се отнася и за аспекти на договор, базирани на проект.      
 
### <a name="edit-a-draft-invoice"></a>Редактиране на чернова на фактура

Когато създавате чернова на фактура по проект, всички нефактурирани продажбени транзакции, които са създадени, когато са одобрени записите за време и разходи, се изтеглят във фактурата. Можете да направите следните корекции, докато фактурата все още е в етап на чернова:

- Изтриване или редактиране на подробностите за ред на фактурата.
- Редактиране и коригиране на количеството и типа фактуриране.
- Директно добавяне на време, разходи, материали и такси като транзакции във фактурата. Можете да използвате тази функция, ако редът от фактурата се съпоставя към ред на договор, който позволява тези класове транзакции.

Изберете **Потвърждаване**, за да потвърдите фактура. Това действие е еднопосочно. Когато изберете **Потвърждаване**, фактурата става само за четене и създава фактурирани действителни продажби от всяка подробност за ред на фактурата за всеки ред на фактурата. Ако подробностите за реда на фактурата се позовават на нефактурирана действителна продажба, нефактурираната действителна продажба се сторнира. Всеки детайл на реда за фактура, който е създаден от запис за време, разход или използване на материали, ще се позовава на действително нефактурирани продажби. Системите за интеграция на главната книга могат да използват това обръщане, за да обърнат незавършената незавършена работа по проекта (WIP) за счетоводни цели.

### <a name="correct-a-confirmed-invoice"></a>Коригиране на потвърдена фактура

Потвърдени фактури могат да бъдат редактирани. Когато коригирате потвърдена фактура, се създава нова чернова на коригираща фактура. Тъй като се предполага, че искате да сторнирате всички транзакции и количества от първоначалната фактура, тази коригираща фактура включва всички транзакции от оригиналната фактура и всички количества в нея са нула.

Ако има транзакции, които не изискват корекция, можете да ги премахнете от черновата на коригираща фактура. Ако искате да сторнирате или да върнете само частично количество, можете да редактирате полето **Количество** в подробностите за реда. Ако отворите подробностите за реда на фактурата, можете да видите количеството в първоначалната фактура. След това можете да редактирате количеството в текущата фактура, така че да е по-малко или повече от количеството в първоначалната фактура.

Когато потвърдите коригираща фактура, първоначално фактурираните действителни продажби се сторнират и се създават нови фактурирани действителни продажби. Ако количеството е било намалено, разликата ще доведе до създаването и на нова нефактурирана действителна продажба. Например, ако първоначалната фактурирана продажба са били за осем часа, а подробностите на реда на коригиращата фактура имат намалено количество от шест часа, редът на първоначално фактурираната продажба се сторнира и създава две нови действителни данни:

- фактурирана действителна продажба за шест часа.
- нефактурирана действителна продажба за оставащите два часа. Тази транзакция може да бъде фактурирана по-късно или отбелязана като неплатима, в зависимост от договорките с клиента.



[!INCLUDE[footer-include](../../includes/footer-banner.md)]
