---
title: Синхронизирайте действителните проекти директно от Project Service Automation с дневника за интегриране на проекти за публикуване в Finance and Operations
description: Тази тема описва шаблонi и основните задачи, които се използват за синхронизиране на прогнозни часове на действителни данни за проект директно от Microsoft Dynamics 365 Project Service Automation във Finance and Operations.
author: KimANelson
manager: AnnBe
ms.date: 07/20/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 87983
ms.assetid: 02ae4986-8e7b-4abe-97d3-cff0904d84de
ms.search.region: Global
ms.author: knelson
ms.search.validFrom: 2016-11-28
ms.dyn365.ops.version: AX 7.3.0
ms.openlocfilehash: 7e5aff102226e5eac2ba3de17407eaa4461cd1ac
ms.sourcegitcommit: 8c786230ef2a497280885b827162561776e2eb00
ms.translationtype: HT
ms.contentlocale: bg-BG
ms.lasthandoff: 03/24/2020
ms.locfileid: "3749311"
---
# <a name="synchronize-project-actuals-directly-from-project-service-automation-to-the-project-integration-journal-for-posting-in-finance-and-operations"></a>Синхронизирайте действителните проекти директно от Project Service Automation с дневника за интегриране на проекти за публикуване в Finance and Operations

[!include[banner](../includes/banner.md)]

Тази тема описва шаблонi и основните задачи, които се използват за синхронизиране на прогнозни часове на действителни данни за проект директно от Dynamics 365 Project Service Automation в Dynamics 365 Finance.

Шаблонът синхронизира транзакции от Project Service Automation в подреждаща таблица във Finance. След завършване на синхронизирането вие **трябва да** импортирайте данните от подготвителната таблица в дневника за интеграция.

> [!NOTE]
> - Интегрирането на действителни проекти е достъпно от версия 8.0.1.
> - Ако използвате Enterprise Edition 7.3.0, след като инсталирате KB 4132657 и KB 4132660, ще можете да използвате шаблоните за интегриране на проектни задачи, категории на транзакционни транзакции, часови прогнози, прогнозни разходи и актуални данни и да конфигурирате заключване на функционалността. Ако трябва да нулирате счетоводните разпределения, препоръчваме да инсталирате и KB 4131710.
> - Ако използвате версия 7.3.0 и пренасяте транзакции с такси от Project Service Automation, трябва да инсталирате KB 4345320, за да включите тези такси във фактурата на проекта.
> - Ако въвеждате суми на данъка върху продажбите навреме или по транзакции в Project Service Automation, трябва да инсталирате Project Service Automation Update 7. В противен случай данъчните факти няма да бъдат свързани със свързаните с тях факти за времето или разходите и няма да бъдат синхронизирани с Finance. За повече информация се свържете с поддръжката.

## <a name="data-flow-for-project-service-automation-to-finance"></a>Поток от данни за Project Service Automation към Finance

Решението за интеграция на Project Service Automation to Finance използва функцията за интегриране на данни, за да синхронизира данните между копията на Project Service Automation и Finance. Шаблоните за интеграция, които се предлагат с функцията за интеграция на данни, позволяват потока от данни за действителни данни на проекта от Project Service Automation към Finance.

Следващата илюстрация показва как данните се синхронизират между Project Service Automation и Finance.

[![Поток от данни за интеграция на Project Service Automation с Finance and Operations](./media/ProjectActualsFlow.jpg)](./media/ProjectActualsFlow.jpg)

## <a name="project-actuals-from-project-service-automation"></a>Действителни данни на проекта от Project Service Automation

### <a name="template-and-tasks"></a>Шаблони и задачи

За достъп до наличните шаблони, в администраторски център на Microsoft Power Apps, изберете **Проекти** и след това в горния десен ъгъл изберете **Нов проект**, за да изберете публични шаблони.

Следният шаблон и основните задачи се използват за синхронизиране на действителните данни на проекта от Project Service Automation към Finance:

- **Име на шаблона в Интегриране на данни:** Действителни данни на проект (PSA до Fin и Ops)
- **Име на задачите в проекта:**

    - Действителни данни
    - TransactionConnections

### <a name="entity-set"></a>Набор от обекти

| Project Service Automation | Finance                                   |
|----------------------------|----------------------------------------------------------|
| Действителни данни                    | Интеграционен обект за фактически проекти                   |
| Връзки на транзакции    | Интеграционен обект за взаимоотношения на проектни транзакции |

### <a name="entity-flow"></a>Поток на обекта

Действителните часове на проекта се управляват в Project Service Automation и се синхронизират с журнала за интеграция на проекта във Finance. Счетоводството ще се прилага въз основа на финансовите измерения по подразбиране и настройката на осчетоводяване.

### <a name="prerequisites"></a>Предварителни изисквания

Преди да може да настъпи синхронизиране на действителни факти, трябва да конфигурирате параметрите за интеграция на Project Service Automation и да синхронизирате проекти, проектни задачи и категории транзакции на проектни разходи.

### <a name="power-query"></a>Power Query

В шаблона за действителни данни на проекта трябва да използвате Microsoft Power Query за Excel, за да изпълните тези задачи:

- Трансформирайте типа транзакция в Project Service Automation в правилния тип транзакция във Finance. Тази трансформация вече е дефинирана в шаблона за актуални проекти (PSA към Fin и Ops).
- Трансформирайте типа фактуриране в Project Service Automation в правилния тип фактуриране във Finance. Тази трансформация вече е дефинирана в шаблона за актуални проекти (PSA към Fin и Ops). След това типът на фактурирането се съпоставя със свойството на реда, въз основа на конфигурацията на страницата **Параметри за интеграция на Project Service Automation**.
- Филтрирайте към конкретни ресурсни организационни единици, които трябва да бъдат синхронизирани с този шаблон.
- Ако действителните междуфирмени времеви или вътрешнофирмени разходи ще бъдат синхронизирани с Finance, трябва да преобразувате договорната организационна единица в правилното юридическо лице във Финансите. В шаблона за актуални проекти (PSA до Fin и Ops) е дефинирана условна колона въз основа на демонстрационни данни. Трябва да актуализирате последната вмъкната условна колона до правилните юридически лица. В противен случай може да възникне или грешка при интеграцията, или неправилни действителни транзакции да бъдат импортирани във Finance.
- Ако междуфирменото време или действителните вътрешнофирмени разходи няма да бъдат синхронизирани с Finance, трябва да изтриете последната вмъкната условна колона от вашия шаблон. В противен случай може да възникне или грешка при интеграцията, или неправилни действителни транзакции да бъдат импортирани във Finance.

#### <a name="contract-organizational-unit"></a>Договор на организационна единица
За да актуализирате вмъкната условна колона в шаблона, щракнете върху стрелката **Карта**, за да отворите картографирането. Изберете връзката **Разширени заявки и филтриране**, за да отворите Power Query.

- Ако използвате шаблона за действителни данни на проекта (PSA до Fin и Ops) по подразбиране, в Power Query изберете последно формуляра **Вмъкнато състояние** в секцията **Приложени стъпки**. В записа **Функция**, заменете **USSI** с името на идентификатора на юридическото лиже, което трябва да се използва с интеграцията. Добавете допълнителни условия към записа **Функция**, както ви е необходимо, и актуализирайте състоянието **иначе** от **USMF** на правилното юридическо лице.
- Ако създавате нов шаблон, трябва да добавите колоната, за да поддържате вътрешнофирменото време и разходи. Изберете **Добавете условна колона** и въведете име за новата колона, като например **LegalEntity**. Въведете условие за колоната, където, ако **msdyn\_contractorganizationalunitid.msdyn\_name** е \<организационна единица\>, след което \<въведете юридическото лице\>; иначе е нула.

### <a name="template-mapping-in-data-integration"></a>Съпоставяне на шаблони при интеграция на данни

Следните илюстрации показват пример за съпоставяне на задача на шаблон при интеграция на данни. Картографирането показва информация за полето, която ще бъде синхронизирана от Project Service Automation към Finance.

[![Съпоставяне на шаблони](./media/ActualsMapping.jpg)](./media/ActualsMapping.jpg)

[![Съпоставяне на шаблони](./media/TransactionConnections.jpg)](./media/TransactionConnections.jpg)

## <a name="import-from-staging-table-after-integration-from-project-service-automation"></a>Импортиране от подреждаща таблица след интеграция от Project Service Automation

Периодичният процес на импортиране от таблица за подреждане трябва да се изпълни след синхронизирането на фактите от Project Service Automation към Finance. Този процес ще импортира проектните транзакции от подготвителната таблица в дневника за интеграция на Project Service Automation, където се прилага счетоводството и импортираните транзакции могат да бъдат осчетоводени. Препоръчваме ви да стартирате този процес в групов режим; по избор може да бъде настроен да работи като повтаряща се партида.

## <a name="update-actuals-from-finance"></a>Актуализирайте актуалните данни от Finance

### <a name="template-and-tasks"></a>Шаблони и задачи

Следният шаблон и основните задачи се използват за синхронизиране на номера на ваучера и данъците върху продажбите за осчетоводени транзакции на проекти от Finance до Project Service Automation:

- **Име на шаблона в Интегриране на данни:** Актуализиране на действителни данни на проект (Fin Ops към PSA)
- **Име на задачите в проекта:**

    - Действителни данни 
    - TransactionConnections

### <a name="entity-set"></a>Набор от обекти

| Finance                                                  | Project Service Automation |
|----------------------------------------------------------|----------------------------|
| Интеграционен обект за фактически проекти                   | Действителни данни                    |
| Интеграционен обект за взаимоотношения на проектни транзакции | Връзки на транзакции    |

### <a name="entity-flow"></a>Поток на обекта

Действителните часове на проекта се управляват в Project Service Automation и се синхронизират с журнала за интеграция на проекта във Finance. След като действителните са публикувани във Finance, те се актуализират в Project Service Automation с номера на ваучера от Finance. Ако данъците върху продажбите са добавени във Finance, се създават нови фактически данъци в Project Service Automation.

### <a name="power-query"></a>Power Query

В шаблона за актуализиране на действителни данни на проекта трябва да използвате Power Query, за да изпълните тези задачи:

- Трансформирайте типа транзакция във Finance в правилния тип транзакция в Project Service Automation. Тази трансформация вече е дефинирана в шаблона за актуализиране на действителни данни в проекта (Fin Ops към PSA).
- Трансформирайте типа фактуриране във Finance в правилния тип фактуриране в Project Service Automation. Тази трансформация вече е дефинирана в шаблона за актуализиране на действителни данни в проекта (Fin Ops към PSA).

### <a name="template-mapping-in-data-integration"></a>Съпоставяне на шаблони при интеграция на данни

Следните илюстрации показват примери на нанасяне на задача за съпоставяне в интеграция на данни. Картографирането показва информация за полето, която ще бъде синхронизирана от Finance в Project Service Automation.

[![Съпоставяне на шаблони](./media/ActualsUpdateMapping.jpg)](./media/ActualsUpdateMapping.jpg)

[![Съпоставяне на шаблони](./media/TransactionConnectionsUpdate.jpg)](./media/TransactionConnectionsUpdate.jpg)
