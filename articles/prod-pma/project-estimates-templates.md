---
title: Синхронизирайте проектните оценки директно от Project Service Automation с Finance and Operations
description: Тази тема описва шаблоните и основните задачи, които се използват за синхронизиране на прогнозни часове на проекта и прогнозни разходи за проекти директно от Microsoft Dynamics 365 Project Service Automation да се Dynamics 365 Finance.
author: Yowelle
ms.date: 07/20/2018
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 87983
ms.assetid: b454ad57-2fd6-46c9-a77e-646de4153067
ms.search.region: Global
ms.author: andchoi
ms.search.validFrom: 2016-11-28
ms.dyn365.ops.version: AX 7.3.0
ms.openlocfilehash: 6696449d80e0915a0c878dbe75cfdf6e268b98ad9f6453bcfc4b424db68021e4
ms.sourcegitcommit: 7f8d1e7a16af769adb43d1877c28fdce53975db8
ms.translationtype: MT
ms.contentlocale: bg-BG
ms.lasthandoff: 08/06/2021
ms.locfileid: "6988188"
---
# <a name="synchronize-project-estimates-directly-from-project-service-automation-to-finance-and-operations"></a>Синхронизирайте проектните оценки директно от Project Service Automation с Finance and Operations

[!include[banner](../includes/banner.md)]

Тази тема описва шаблоните и основните задачи, които се използват за синхронизиране на прогнозни часове на проекта и прогнозни разходи за проекти директно от Dynamics 365 Project Service Automation да се Dynamics 365 Finance.

> [!NOTE]
> - Интеграция на проектни задачи, категории транзакции, прогнози за часове, оценки на разходите и заключване на функционалността е налична във версия 8.0.
> - Интегрирането на действителни данни е достъпно от версия 8.0.1.

## <a name="data-flow-for-project-service-automation-to-finance"></a>Поток от данни за Project Service Automation към Finance

Решението за интеграция на Project Service Automation to Finance използва функцията за интегриране на данни, за да синхронизира данните между копията на Project Service Automation и Finance. Шаблоните за интеграция, които се предлагат с функцията за интеграция на данни, позволяват потока от данни за прогнозни часови прогнози на проекта и прогнозни разходи за проекти от Project Service Automation към Finance.

Следващата илюстрация показва как данните се синхронизират между Project Service Automation и Finance.

[![Поток от данни за интеграция на Project Service Automation с Finance.](./media/ProjectEstimatesFlow.png)](./media/ProjectEstimatesFlow.png)

## <a name="project-hour-estimates"></a>Прогнозни оценки на часове

### <a name="template-and-tasks"></a>Шаблони и задачи

За достъп до наличните шаблони, в администраторски център на Microsoft Power Apps, изберете **Проекти** и след това в горния десен ъгъл изберете **Нов проект**, за да изберете публични шаблони.

Следният шаблон и основните задачи се използват за синхронизиране на прогнозите за часовете на проекта от Project Service Automation към Finance:

- **Име на шаблона в Интегриране на данни:** Приблизителни прогнозни часове (PSA до Fin и Ops)
- **Име на задачите в проекта:**

    - Релации на трансакция
    - Прогнози за разноски

### <a name="entity-set"></a>Набор от обекти

| Project Service Automation | Finance                                       |
|----------------------------|-----------------------------------------------|
| Задачи от проекти              | Интеграционен обект за прогнозни часови оценки на проекта |

### <a name="entity-flow"></a>Поток на обекта

Прогнозите за часовете на проекта се управляват в Project Service Automation и се синхронизират с Finance като прогнози за часовете на проекта.

### <a name="prerequisites"></a>Предварителни изисквания

Преди да може да се извърши синхронизиране на прогнозни часови оценки на проекта, трябва да синхронизирате проекти, проектни задачи и категории транзакции на проектни разходи.

### <a name="power-query"></a>Power Query

В шаблона за прогнозни часове на проекта трябва да използвате Microsoft Power Query за Excel, за да изпълните тези задачи:

- Задайте идентификатора на модела за прогноза по подразбиране, който ще се използва, когато интеграцията създава нови часови прогнози.
- Филтрирайте всички специфични за ресурса записи в задачата, които ще пропуснат интеграцията в прогнози за час.
- Филтрирайте всички празни редове от категории транзакции. Неизпълнението на тази задача може да доведе до неправилни прогнози за часа.

#### <a name="set-the-default-forecast-model-id"></a>Задайте стандартния идентификатор на модела за прогноза

За да актуализирате идентификатора на модела по подразбиране в шаблона, щракнете върху стрелката **Карта**, за да отворите картографирането. След това изберете връзката **Разширени заявки и филтриране**.

- Ако използвате шаблона за прогнозни часове на проекта (PSA до Fin и Ops) по подразбиране, изберете **Вмъкнато състояние** в списъка на **Приложени стъпки**. Във **Функцията** влизане, замяна **О\_прогноза** с името на идентификатора на прогнозния модел, който трябва да се използва с интеграцията. Шаблонът по подразбиране има идентификационен номер на прогнозен модел от демонстрационните данни.
- Ако създавате нов шаблон, трябва да добавите тази колона. В Power Query изберете **Добавете условна колона** и въведете име за новата колона, като например **ModelID**. Въведете условието за колоната, където, ако задачата на проекта не е нула, тогава \<enter the forecast model ID\>; иначе е нула.

#### <a name="filter-out-resource-specific-records"></a>Филтрирайте специфичните за ресурсите записи

Шаблонът за прогнозни часове на проекта (PSA до Fin и Ops) има филтър по подразбиране, който премахва всички специфични за ресурса записи. Ако създадете свой собствен шаблон, трябва да добавите този филтър. Изберете **Разширени заявки и филтриране** връзка за филтриране на **msdyn\_islinetask** колона, така че само записите **Невярно** са включени.

#### <a name="filter-out-empty-transaction-category-rows"></a>Филтрирайте празни редове от категории транзакции

Трябва да добавите филтър, за да премахнете всички редове, които имат празни категории транзакции. Тази задача е задължителна, независимо дали използвате шаблона по подразбиране или създавате свой собствен шаблон. Този филтър премахва всички обобщени редове от Project Service Automation, които могат да доведат до неправилни прогнози за часа във Finance. Изберете връзката **Разширени заявки и филтриране** за филтриране на нулеви записи в **msdyn\_категория на транзакциите\_стойност** колона.

### <a name="template-mapping-in-data-integration"></a>Съпоставяне на шаблони при интеграция на данни

Следващата илюстрация показва пример за съпоставяне на задача на шаблон при интеграция на данни. Картографирането показва информация за полето, която ще бъде синхронизирана от Project Service Automation към Finance.

[![Съпоставяне на задача на шаблони в интеграция на данни.](./media/ProjectHourEstimatesMapping.jpg)](./media/ProjectHourEstimatesMapping.jpg)

## <a name="project-expense-estimates"></a>Прогнози за разход по проект

### <a name="template-and-tasks"></a>Шаблони и задачи

Следният шаблон и основните задачи се използват за синхронизиране на прогнозите за разходи на проекта от Project Service Automation към Finance:

- **Име на шаблона в Интегриране на данни:** Приблизителни прогнозни разходи (PSA до Fin и Ops)
- **Име на задачите в проекта:**

    - Релации на трансакция 
    - Прогнози за разноски

### <a name="entity-set"></a>Набор от обекти

| Project Service Automation | Finance                                                  |
|----------------------------|----------------------------------------------------------|
| Връзки на транзакции    | Интеграционен обект за взаимоотношения на проектни транзакции |
| Редове за оценки             | Интеграционен обект за прогнозни разходи на проекта         |

### <a name="entity-flow"></a>Поток на обекта

Прогнозите за разходи на проекта се управляват в Project Service Automation и се синхронизират с Finance като прогнози за разходи на проекта.

### <a name="prerequisites"></a>Предварителни изисквания

Преди да може да се извърши синхронизиране на прогнозни разходи проекта, трябва да синхронизирате проекти, проектни задачи и категории транзакции на проектни разходи.

### <a name="power-query"></a>Power Query

В шаблона за прогнозни разходи на проекта трябва да използвате Power Query за Excel, за да изпълните следните задачи:

- Филтрирайте, за да включите само редовите записи за оценка на разходите.
- Задайте идентификатора на модела за прогноза по подразбиране, който ще се използва, когато интеграцията създава нови часови прогнози.
- Трансформирайте видовете фактуриране.
- Трансформирайте видовете трансакция.

#### <a name="filter-to-include-only-expense-estimate-lines"></a>Филтрирайте, за да включите само редовите прогнози за разходи

Шаблонът за прогнозни разходи за проекта (PSA към Fin и Ops) има филтър по подразбиране, който включва само разходни редове в интеграцията. Ако създадете свой собствен шаблон, трябва да добавите този филтър. Изберете **Транзакционни отношения** и след това щракнете върху стрелката **Карта**, за да отворите картографирането. Изберете връзката **Разширени заявки и филтриране**. Филтрирайте колона **msdyn\_transactiontype1**, така че да включва само **msdyn\_estimateline**.

#### <a name="set-the-default-forecast-model-id"></a>Задайте стандартния идентификатор на модела за прогноза

За да актуализирате идентификатора на модела по подразбиране в шаблона, изберете задача **Прогнози за разходи** и след това щракнете върху стрелката **Карта**, за да отворите картографирането. Изберете връзката **Разширени заявки и филтриране**.

- Ако използвате шаблона за прогнозни разходи на проекта (PSA до Fin и Ops) по подразбиране, в Power Query изберете първо формуляра **Вмъкнато състояние** в секцията **Приложени стъпки**. Във **Функцията** влизане, замяна **О\_прогноза** с името на идентификатора на прогнозния модел, който трябва да се използва с интеграцията. Шаблонът по подразбиране има идентификационен номер на прогнозен модел от демонстрационните данни.
- Ако създавате нов шаблон, трябва да добавите тази колона. В Power Query изберете **Добавете условна колона** и въведете име за новата колона, като например **ModelID**. Въведете условието за колоната, където, ако ИД на ред на прогноза не е нула, тогава \<enter the forecast model ID\>; иначе е нула.

#### <a name="transform-the-billing-types"></a>Трансформирайте видовете фактуриране

Шаблонът за прогнозни разходи за проект (PSA към Fin и Ops) включва условна колона, която се използва за трансформиране на типовете фактури, получени от Project Service Automation по време на интеграцията. Ако създадете свой собствен шаблон, трябва да добавите тази условна колона. Изберете **Разширени заявки и филтриране** връзка и след това изберете **Добавете условна колона**. Въведете име за новата колона, като например **BillingType**. След това въведете следното условие:

Ако **msdyn\_тип фактуриране** = 192350000, тогава **NonChargeable**  
иначе ако **msdyn\_тип фактуриране** = 192350001, тогава **Chargeable**  
иначе ако **msdyn\_тип фактуриране** = 192350002, тогава **Complimentary**  
друго **NotAvailable**

#### <a name="transform-the-transaction-types"></a>Трансформирайте видовете трансакция

Шаблонът за прогнозни разходи за проект (PSA към Fin и Ops) включва условна колона, която се използва за трансформиране на типовете трансакции, получени от Project Service Automation по време на интеграцията. Ако създадете свой собствен шаблон, трябва да добавите тази условна колона. Изберете **Разширени заявки и филтриране** връзка и след това изберете **Добавете условна колона**. Въведете име за новата колона, като например **TransactionType**. След това въведете следното условие:

Ако **msdyn\_код на транзакцията** = 192350000, тогава **Разходи**  
иначе ако **msdyn\_код на транзакцията** = 192350005, тогава **Продажби**  
иначе **нула**

### <a name="template-mapping-in-data-integration"></a>Съпоставяне на шаблони при интеграция на данни

Следните илюстрации показват примери на нанасяне на задача за съпоставяне в интеграция на данни. Картографирането показва информация за полето, която ще бъде синхронизирана от Project Service Automation към Finance.

[![Съпоставяне на шаблон на трансакции за прогноза за разходи.](./media/ExpenseEstimateTransactionRelationshipsMapping.jpg)](./media/ExpenseEstimateTransactionRelationshipsMapping.jpg)

[![Съпоставяне на шаблон за прогнози за разходи.](./media/ExpenseEstimatesMapping.jpg)](./media/ExpenseEstimatesMapping.jpg)


[!INCLUDE[footer-include](../includes/footer-banner.md)]