---
title: Персонализиране на седмичния запис за време
description: Тази тема предоставя информация как да се приложат персонализираните бизнес правила, които поддържат практиките на организацията.
author: stsporen
manager: kfend
ms.service: project-operations
ms.custom:
- dyn365-projectservice
ms.date: 07/09/2019
ms.topic: article
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365CE
- D365PS
- ProjectOperations
ms.openlocfilehash: f1c8e150500334e87b25a1c8d04cf28c7b7beaeb
ms.sourcegitcommit: fa32b1893286f20271fa4ec4be8fc68bd135f53c
ms.translationtype: HT
ms.contentlocale: bg-BG
ms.lasthandoff: 02/15/2021
ms.locfileid: "5282050"
---
# <a name="customize-weekly-time-entry"></a>Персонализиране на седмичен запис за време 

[!include [banner](../includes/psa-now-project-operations.md)]

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

В Microsoft Dynamics 365 Project Service Automation версия 3.3 Microsoft въведе модерна мрежа, която позволява ресурсите за проекта бързо да въвеждат време за до една седмица едновременно. Новата мрежа за седмични записи за време може да показва общи стойности за записите по дата, ред или седмица. Ресурсите могат да правят копия на записи за време в рамките на седмицата, както и групово копиране от предходни седмици. Системните персонализатори могат да персонализират изгледа, като добавят полета и заявки към други обекти и прилагат персонализирани бизнес правила, за да поддържат практиките на организацията си.

Записът за време и новата мрежа за седмични часове са достъпни чрез картата на сайта. Неразширяемата персонализирана функционалност за запис за време, която беше част от по-стари версии на PSA, е заменена от разширяема мрежа за седмични записи за време, а също и от алтернативна функционалност в мрежата само за четене и календара. Благодарение на тази промяна потребителите могат да въвеждат време в седмични стойности.

## <a name="page-layout"></a>Оформление на страница
Новата мрежа на седмичните записи за време е персонализирана контрола, която има лента с инструменти и две основни секции – **Измерения** и **Продължителност**. Лентата с инструменти включва бутон, който се отнася само за тази персонализирана контрола за мрежата за записи за време. За разлика от това, бутоните в екрана „Действие“ в горната част на страницата се прилагат за трите типа контроли, които се поддържат за въвеждане на време: контролата за седмичен запис за време, контролата само за четене и контролата на календара.

### <a name="dimensions"></a>Измерения
Секцията **Измерения** показва като заглавки на колони всички измерения, към които може да бъде въведено време. Следните измерения са поддържат стандартно:

- Проект
- Задача от проект
- Роля
- Тип
- Състояние на записа

Секцията **Измерения** не позволява вградено редактиране. Тази секция се поддържа от изглед, който позволява добавяне на персонализирани полета към мрежата за седмични записи за време. За информация как да добавите персонализирани полета вижте раздела „Разширяемост“ по-нататък в тази тема.

### <a name="duration"></a>Продължителност
Разделът „Продължителност“ показва дните от седмицата като заглавки на колоните. Тази секция позволява вградено редактиране. След създаването на ред за запис за време, който има подходящи измерения, потребителите могат бързо да въвеждат вградено количеството време, изразходвано за тези измерения.

## <a name="create-a-new-time-entry"></a>Създаване на нов запис за време
За да създадете нов запис за време в мрежата за записи за време, изберете **Нов**. Показва се диалоговият прозорец **Бързо създаване на запис за време**. В този диалогов прозорец потребителите могат да изберат датата на записа за време и след това да въведат данни за измеренията **Проект**, **Задача от проект**, **Роля** и **Продължителност** в минути, часове или дни, като въведете **h**, **m** или **d**, заедно с числото. Потребителите могат също да въвеждат описание и коментари, които могат да се споделят външно за записа за време. Когато потребителите записват промените си, стойностите, които са въвели към измеренията, се показват в секцията **Измерения**. Информацията за продължителността, която са въвели в полето **Продължителност**, се показва в датата на създаване на записа за време.

Справочните полета се поддържат от системни изгледи. След като потребител въведе проект, полето **Задача по проекта** се настройва на изгледа **Копиране** по подразбиране. За да създадете записи за време за задачи, които не са присвоени на потребител, изберете **Промяна на изгледа** в диалоговия прозорец за справка и след това изберете изгледа **Всички активни задачи по проекта**.

## <a name="edit-a-time-entry"></a>Редактиране на запис за време
Подробности от някои полета на страницата за записи за време, като например **Описание** и **Външни коментари**, не се показват в мрежата за седмични записи за време. Вместо това малък триъгълен индикатор се появява в клетките с продължителност, които имат тези допълнителни подробности. Изберете клетката и след това изберете **Редактиране на подробности**, за да прегледате данните в прозореца **Бързо редактиране**. За да редактирате или актуализирате подробностите за определен запис за време, който не е част от мрежата за седмични записи за време, потребителите трябва да отворят прозореца **Бързо редактиране**.

## <a name="copy-a-time-entry-row"></a>Копиране на ред на запис за време
След като първият ред на запис за време е създаден, потребителите могат да изберат **Копиране на ред**, за да копират целия ред в нов ред. Когато даден ред се копира по този начин, измеренията и продължителностите също се копират. Потребителите също така могат да изберат **Редактиране на ред**, за да актуализират вътрешно стойности и измерения в секцията **Продължителност**.

## <a name="open-a-time-entry"></a>Отваряне на запис за време
За да поддържа оптимално и бързо въвеждане в най-важните полета, мрежата за седмични записи за време показва поднабор от избрани измерения и продължителност. За да видите всички подробности за един запис за време, под **Редактиране на запис** изберете **Отваряне**.

## <a name="submit-a-time-entry"></a>Подаване на запис за време
Потребителите могат да подават един запис за време или група записи за време, като изберат блок от клетки или цял ред от записи за време и след това изберат **Подаване**. Подадените записи за време се показват като записи, които чакат одобрение на страницата **Одобрение** на одобряващите. След като бъдат успешно подадени, записите за време не могат да бъдат редактирани.

## <a name="recall-a-time-entry"></a>Оттегляне на запис за време
Можете да оттеглите записите за време, които сте подали. Можете да оттеглите един запис за време, блок от записи за време или цял ред записи за време. Оттеглените записи за време са налични за ресурсите за редактиране.

## <a name="time-entry-status"></a>Състояние на запис за време
Нови записи за време автоматично получават състояние **Чернова**. Когато запис за време бъде подаден, състоянието се актуализира на **Подадено**. Когато подаден запис за време бъде одобрен, състоянието се актуализира на **Одобрено**. Ако запис на време бъде отхвърлен, състоянието се актуализира на **Върнат**, а записът става достъпен за корекция и повторно подаване. Само записите за време, които имат състояние **Чернова**, могат да бъдат изтрити.

## <a name="view-rejection-comments"></a>Преглед на коментари за отхвърлянето
Когато даден запис за време бъде отхвърлен от одобряващ, одобряващият може да добави коментари за отхвърляне, за да помогне на ресурса да разбере причината за отхвърлянето. За да прегледате коментарите за отхвърляне за запис за време, изберете **Отваряне на запис**. Коментарите за отхвърляне ще бъдат показани във времевата линия. Във времевата линия ресурсът може да отговори на коментарите за отхвърляне, преди да подаде отново записа.

## <a name="copy-week"></a>Копиране на седмица
След като са създадени няколко записа за време, потребителите могат да изберат **Копиране на седмица** за групово създаване на допълнителни записи за време. Показва се диалоговият прозорец **Копиране**. В секцията **От период** използвайте полетата **Начална дата** и **Крайна дата**, за да дефинирате интервала, от който да се копират записи за време. В секцията **В период** в полето **Начална дата** посочете датата, за която да се създадат записи за време. След това изберете **Копиране**. За посочената дата в периода „До“ се създава копие на записите за време за съответния ден от седмицата в периода „От“. Например записът за време за понеделник от миналата седмица ще бъде копиран в понеделника на седмицата, посочена като период „До“.

## <a name="import"></a>Импортиране
Същият основен процес се използва за импортиране от резервации, присвоявания и замени. Потребителите могат да посочат диапазона от дати, от който да се импортират резервациите. След това те трябва изрично да изберат резервациите, които трябва да бъдат копирани в черновите на записи за време. В предишното издание предлаганите записи за време се показваха в мрежата и календара и се загубваха при обновяване на сесията.

## <a name="extensibility"></a>Възможност за разширение
### <a name="add-custom-fields-that-have-lookups-to-other-entities"></a>Добавяне на персонализирани полета, които имат справочни полета за други обекти
Има три основни стъпки за добавяне на персонализирано поле към мрежата на седмични записи за време.

1.  Добавете персонализирано поле в диалоговия прозорец за бързо създаване.
2.  Конфигурирайте мрежата, за да се показва персонализираното поле.
3.  Добавете персонализираното поле към потока от задачи за редактиране на ред или потока от задачи за редактиране на клетка, според случая.

Трябва също да се уверите, че новото поле има необходимите валидирания в потока от задачи за редактиране на ред или клетка. Като част от тази стъпка трябва да заключите полето въз основа на състоянието на записа за време.

#### <a name="add-the-custom-field-to-the-quick-create-dialog-box"></a>Добавяне на персонализираното поле в диалоговия прозорец за бързо създаване
Трябва да добавите персонализираното поле към диалоговия прозорец за бързо създаване „Създаване на запис за време“, така че потребителите да могат да въведат стойност за него, когато добавят записи за време с помощта на бутона **Нов**.

#### <a name="configure-the-grid-to-show-the-custom-field"></a>Конфигуриране на мрежата, за да се показва персонализираното поле
Има два начина за добавяне на персонализирано поле към мрежата на седмични записи за време. Първата опция е да персонализирате изгледа **Моите седмични записи за време** и да добавите персонализирано поле към него. Можете да изберете позицията и размера на персонализирано поле в мрежата, като редактирате тези свойства в изгледа.

Втората опция е да създадете нов изглед на персонализиран за запис за време и да го зададете като изглед по подразбиране. Този изглед трябва да съдържа полетата **Описание** и **Външни коментари** в допълнение към колоните, които искате да имате в мрежата. Можете да изберете позицията, размера и реда на сортиране по подразбиране на мрежата, като редактирате тези свойства в изгледа. След това конфигурирайте персонализираната контрола за този изглед, така че да е контрола **Мрежа за записи за време**. Добавете тази контрола към изгледа и я изберете за уеб, телефон и таблет. След това конфигурирайте параметрите за мрежата за седмични записи за време. Задайте полето **Начална дата** на **msdyn_date**, задайте полето **Продължителност** на **msdyn_duration** и задайте полето **Състояние** на **msdyn_entrystatus**. За изгледа по подразбиране полето **Списък на състоянието само за четене** се задава на **192350002, 192350003, 192350004**, полето **Поток от задачи за редактиране на ред** се задава на **msdyn_timeentryrowedit** и полето **Поток от задачи за редактиране на клетка** се задава на **msdyn_timeentryedit**. Можете да персонализирате тези полета, за да добавите или премахнете състояние само за четене или да използвате различна функционалност, базирана на задачи (TBX), за редактиране на редове или клетки. Тези полета трябва да бъдат обвързани със статична стойност.

#### <a name="add-the-custom-field-to-the-appropriate-edit-task-flow"></a>Добавяне на персонализирано поле към съответния поток от задачи за редактиране
TBX страниците, които се използват за редактиране, могат да бъдат намерени под **Процеси**. Страниците по подразбиране са **Project Service – редактиране на ред на запис за време** и **Project Service – редактиране на запис за време**. Можете или да редактирате тези страници по подразбиране, или да създадете нови потребителски TBX страници.

> [!NOTE] 
> И двете опции ще премахнат някои стандартни филтрирания в обектите **Проект** и **Задача на проект**, така че всички справочни изгледи за обектите ще бъдат видими. Стандартно се виждат само съответните справочни изгледи.

Трябва да определите подходящия поток от задачи за персонализираното поле. Най-вероятно, ако сте добавили полето към мрежата, трябва да отидете в потока от задачи за редактиране на ред, който се използва за полета, които се прилагат за целия ред от записи за време. Ако персонализираното поле има уникална стойност всеки ден, като например персонализирано поле за **Краен час**, трябва да отидете в потока от задачи за редактиране на клетка.

За да добавите персонализираното поле към поток от задачи, плъзнете елемент **Поле** в съответната позиция на страницата и след това задайте свойствата му. Задайте свойството **Източник** на **Запис за време** и задайте свойството **Поле за данни** на персонализираното поле. Свойството **Поле** посочва показваното име на TBX страницата. Изберете **Прилагане**, за да запазите промените в полето. След това изберете **Актуализиране**, за да запазите промените в страницата.

За да използвате нова потребителска TBX страница вместо това, създайте нов процес. Задайте категорията на **Поток на бизнес процес**, задайте обекта на **Запис за време** и задайте типа на бизнес процеса на **Изпълнение на процес като поток от задачи**. Под **Свойства** свойството **Име на страница** трябва да бъде зададено на показваното име за страницата. Добавете всички съответни полета към TBX страницата. Запишете и активирайте процеса и след това актуализирайте свойството на персонализираната контрола за съответния поток от задачи на стойността на **Име** в процеса.

### <a name="add-new-option-set-values"></a>Добавяне на стойности на нов набор от опции
За да добавите стойности на набор от опции към стандартно поле, отворете страницата за редактиране за полето и след това под **Тип** изберете **Редактиране** до набора от опции. След това добавете нова опция, която има персонализиран етикет и цвят. Ако искате да добавите ново състояние на запис за време, стандартното поле се нарича **Състояние на запис**, а не **Състояние**.

### <a name="designate-a-new-time-entry-status-as-read-only"></a>Обозначаване на ново състояние на запис за време като само за четене
За да обозначите ново състояние на запис за време като само за четене, добавете новата стойност на записа за време (номера, а не етикета) в свойството **Списък със състояния само за четене**. Редактируемата част на мрежата на записа за време ще бъде заключена за редове, които имат новото състояние.
След това добавете бизнес правила, за да заключите всички полета в TBX страниците **Редактиране на ред на записи за време** и **Редактиране на записи за време**. Можете да осъществите достъп до бизнес правилата за тези страници, като отворите редактора на поток на бизнес процес за страницата и след това изберете **Бизнес правила**. Можете да добавите новото състояние към условието в съществуващите бизнес правила или да добавите ново бизнес правило за новото състояние.

### <a name="add-custom-validation-rules"></a>Добавяне на персонализирани правила за валидиране
Има два вида правила за валидиране, които можете да добавите за функционалността на мрежа за седмични записи за време: • бизнес правила от страната на клиента, които работят в диалогови прозорци за бързо създаване и в TBX страници • валидиране на добавки от страната на сървъра, които се отнасят за всички актуализации за въвеждане на време

#### <a name="business-rules"></a>Бизнес правила
Използвайте бизнес правила, за да заключвате и отключвате полета, въвеждате стойности по подразбиране в полетата и дефинирате валидации, които изискват информация само от записа на текущия запис за време. Можете да осъществите достъп до бизнес правилата за TBX страница, като отворите редактора на поток на бизнес процес за страницата и след това изберете **Бизнес правила**. След това можете да редактирате съществуващите бизнес правила или да добавите ново бизнес правило. За още по-персонализирани валидирания можете да използвате бизнес правило за изпълнение на JavaScript.

#### <a name="plug-in-validations"></a>Валидирания на добавки
Трябва да използвате валидирания на добавки за всички валидирания, които изискват повече контекст, отколкото е наличен в един запис за запис на време, или за всички валидирания, които искате да стартирате за вградени актуализации в мрежата. За да завършите валидирането, създайте персонализирана добавка в обекта **Запис за време**.

> [!IMPORTANT] 
> В момента известен проблем на TBX страниците не позволява на потребителите да коригират информация и да избират повторно „Готово“, когато актуализацията не успее да валидира добавка. Като заобиколно решение настройте валидирания на бизнес правила да предотвратяват тази ситуация, доколкото е възможно.


[!INCLUDE[footer-include](../includes/footer-banner.md)]