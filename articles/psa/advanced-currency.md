---
title: Многовалутни сценарии (версия 3.x)
description: Тази статия предоставя информация за многовалутни сценарии.
author: rumant
ms.custom:
- dyn365-projectservice
ms.date: 12/26/2018
ms.topic: article
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365CE
- D365PS
- ProjectOperations
ms.reviewer: johnmichalak
ms.openlocfilehash: 0c302526991f8887395c11fb6c07dd29f5e6f65d
ms.sourcegitcommit: 6cfc50d89528df977a8f6a55c1ad39d99800d9b4
ms.translationtype: MT
ms.contentlocale: bg-BG
ms.lasthandoff: 06/03/2022
ms.locfileid: "8925475"
---
# <a name="multiple-currency-scenarios"></a>Многовалутни сценарии

[!include [banner](../includes/psa-now-project-operations.md)]

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

Microsoft Dynamics 365 има две концепции за валути:

- **Валута на транзакцията** – валутата, в която се извършва дадена транзакция. 
- **Основна валута** – валутата на екземпляра на Dynamics 365. Тази валута се настройва, когато се осигури екземпляр на Dynamics 365. Тя не може да се променя.

Например Contoso САЩ продава 100 тениски на клиент в Обединеното кралство за 15 лири стерлинги (GBP) всяка. Следващата таблица показва как тази транзакция се записва в обекта „Поръчка на продукт“.

| Продукт | Количество | Единична цена | Валута | Сума | Обменен курс | Единична цена (основна)| Сума (основна)|
|---------|----------|----------------|----------|--------|---------------|----------------------|--------------|
| Тениска | 100      | 15             | GBP      | 1500   | 0,94          | 17,25 щ.д.               | 1725 щ.д.       |

Колоната **Валута** показва валутата на транзакцията, която е валутата, в която е извършена продажбата. Колоната **Обменен курс** е обменният курс между валутата на транзакцията и основната валута. Основната валута е щатски долар (USD). Основната валута е била настроена, когато е бил осигурен екземплярът на Dynamics 365.
Както показва таблицата, всяка транзакция се записва както във валутата на транзакцията, така и в основната валута. Dynamics 365 използва валутния курс, за да изчисли сумите на основната валута.

## <a name="project-service-automation-extensions"></a>Разширения на Project Service Automation

Dynamics 365 Project Service Automation оказва влияние върху валутата на транзакцията, тъй като бизнес транзакциите обикновено имат два аспекта: разходи и продажби.

Следните обекти се считат за бизнес транзакции:

- Подробности за ред на оферта
- Подробности за ред на договор по проект
- Ред за прогнозна оценка
- Счетоводен запис
- Подробности за ред на фактура
- Действителни данни

Във всеки от тези обекти има запис, който представлява сумата на разходите или сумата на продажбите. Що се отнася до обекти на Dynamics 365, които имат поле **Сума**, всеки запис включва суми във валутата на транзакцията и в основната валута. 

PSA разширява концепцията за валутата на транзакцията за разходите и продажбите по следните начини:

- Валутата на транзакцията за разходите за времеви транзакции винаги идва от валутата на организационната единица, която притежава или управлява проекта. Тази организационна единица е известна като единица, сключваща договора.
- Валутата на транзакцията за продажби за транзакции за време и разходи винаги идва от валутата на договора по проекта.
- Валутата на транзакцията за разходите идва от валутата, в която е създаден записът за разходи.

## <a name="multiple-currency-scenario"></a>Многовалутен сценарий

Този раздел описва пример за проект, който Contoso ОК доставя за клиент, който се нарича Fabrikam, Япония. Ето как е настроен сценарият:

1. GBP и японска йена (JPY) се настройват в **Настройки** \> **Бизнес управление** \> **Валута**. 
2. Настройва се акаунт на клиент, който се нарича **Fabrikam – Япония**, и JPY се избира като валута на акаунта.
3. Настройва се организационна единица, която се нарича **Contoso ОК**, и GBP се избира като валута.
4. Създава се договор по проект, където **Contoso ОК** се посочва като единица, сключваща договора, а **Fabrikam – Япония** се посочва като клиент.
5. Редовете на договор по проект се създават въз основа на правилата за фактуриране за различните класове транзакции по проекта, като например фактуриране за време спрямо фактуриране за разходи.
6. Създаден е проект, където **Contoso ОК** е посочен като единица, сключваща договора. Този проект се създава и съпоставя с редовете на договора по проекта.


По време на оценката, която използва подробностите за реда на офертата, подробностите за реда на договора по проекта, или в реда за прогноза на графика, два записа винаги се създават в обекта. Единият запис е за разходи, а другият запис е за продажби.

- По подразбиране валутата на транзакцията в записа за разходи се задава на валутата на единицата на проекта, сключваща договора. В този пример валутата е GBP.
- По подразбиране валутата на транзакцията в записа за продажба се задава на валутата на договора по проекта. В този пример валутата е JPY.

Когато се създават действителни данни за време с помощта на запис за време или счетоводен запис, възниква следното поведение:

- По подразбиране валутата на транзакцията в записа за разходи се задава на валутата на единицата на проекта, сключваща договора.
- По подразбиране валутата на транзакцията в записа за продажба се задава на валутата на договора по проекта.

Когато се създават действителни данни за разходи чрез записа за разход или счетоводен запис, възниква следното поведение:

- Можете да запишете сумата на разходите във всяка валута. Изберете валутата, като използвате функцията за избор на валута на страницата **Запис за разход** или **Счетоводен запис**. По подразбиране валутата на транзакцията за записа за разход се задава на валутата в записа за разход. 
- По подразбиране валутата на транзакцията за записа за продажба е валутата на договора по проекта. За да зададе тази валута, системата първо преобразува сумата на транзакцията във валутата, която потребителят е въвел в основната валута. След това конвертира сумата във валутата на договора по проекта. 

### <a name="computing-roll-ups-when-project-actuals-are-recorded-in-multiple-transaction-currencies"></a>Изчисляване на сумарни полета, когато действителните данни се записват в няколко валути на транзакциите

Dynamics 365 автоматично обработва сумарните полета на сумите в различни валути. Ето един пример.

| Клас на транзакция | Тип транзакция| Дата   | Ресурс | Категория на транзакция | Количество | Единична цена | Сума      | Обменен курс | Сума в основна |
|-------------------|------------------|--------|----------|----------------------|----------|--------------|-------------|---------------|----------------|
| Време              | Нефактурирани продажби   | 14-юни | Драган  |                      | 8 часа    | 20 000 JPY    | 160 000 JPY | 123           | 1300,81 USD    |
| Време              | Нефактурирани продажби   | 15-юни | Драган  |                      | 8 часа    | 20 000 JPY    | 160 000 JPY | 123           | 1300,81 USD    |
| Разход           | Нефактурирани продажби   | 16-юни | Драган  | Хотел                | 1 ед.     | 250 EUR      | 250 EUR     | 0.94          | 265,95 USD     |
| Разход           | Нефактурирани продажби   | 17-юни | Драган  | Коли под наем           | 1 ед.     | 150 EUR      | 150 EUR     | 0,94          | 159,57 USD     |

За да изчислите общата стойност на нефактурираните продажби в проекта, можете да създадете сборно поле за полето **Сума** за всички свързани действителни данни за нефактурирани продажби. Сборното поле е конструкция на Dynamics 365, която дава възможност за бързи формули в свързани записи.


[!INCLUDE[footer-include](../includes/footer-banner.md)]
